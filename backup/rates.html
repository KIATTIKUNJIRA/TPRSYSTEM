
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rates â€” TPR Digital Hub</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="./shared.css" rel="stylesheet">
</head>
<body>
  <div id="navbar"></div>
  <div class="container-narrow">
    <h4 class="mb-2">Rates</h4>
    <div class="card p-3">
      <div class="row g-2 mb-2">
        <div class="col-sm-6">
          <select id="person" class="form-select"></select>
        </div>
      </div>
      <div class="table-responsive">
        <table class="table table-sm align-middle">
          <thead class="table-light">
            <tr><th>Effective from</th><th>Effective to</th><th>Currency</th><th class="text-end">Rate/hour</th></tr>
          </thead>
          <tbody id="rows"></tbody>
        </table>
      </div>
    </div>
  </div>
  <script type="module">
    import {PEOPLE, RATES, renderNavbar} from './shared.js';
    document.getElementById('navbar').innerHTML = renderNavbar('rates');
    const personEl = document.getElementById('person');
    PEOPLE.forEach(p=>{ const opt=document.createElement('option'); opt.value=p.id; opt.textContent=`${p.first_name} ${p.last_name}`; personEl.appendChild(opt); });
    personEl.value = PEOPLE[1].id;

    const rowsEl = document.getElementById('rows');
    function render(){
      const pid = Number(personEl.value);
      rowsEl.innerHTML = '';
      RATES.filter(r=> r.person_id===pid).sort((a,b)=> new Date(b.effective_from)-new Date(a.effective_from)).forEach(r=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${r.effective_from}</td><td>-</td><td>${r.currency}</td><td class="text-end">${r.rate_per_hour.toLocaleString()}</td>`;
        rowsEl.appendChild(tr);
      });
    }
    personEl.onchange = render; render();
  </script>
</body>
</html>
